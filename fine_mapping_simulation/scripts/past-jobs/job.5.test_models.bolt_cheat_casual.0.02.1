#!/bin/bash
#SBATCH --mem 32G
#SBATCH -c 4
#SBATCH -t 00:15:00
source /home/patrickgibbs/.bashrc
conda activate myenv1
mkdir small_chunks_current/chunked_sims/chucks_1_marker_her_0.02_ind50000_casual_1/models/bolt_cheat_casual
rm small_chunks_current/chunked_sims/chucks_1_marker_her_0.02_ind50000_casual_1/models/bolt_cheat_casual/params_$i
touch small_chunks_current/chunked_sims/chucks_1_marker_her_0.02_ind50000_casual_1/models/bolt_cheat_casual/params_$i
for ((i=0; i<20; i++)); do
    for he_t in 0.0005 0.001 0.002 0.004 0.008 0.016 0.032 0.064 0.128 0.256; do
    # make the params file for bolt
    num_lines=$(wc -l < small_chunks_current/chunked_sims/chucks_1_marker_her_0.02_ind50000_casual_1/fine_map_gwas/sample_${i}.summaries)
    casual_prop=$(echo "scale=7; 1/$num_lines" | bc)
    echo "$he_t 0$casual_prop 0" >> small_chunks_current/chunked_sims/chucks_1_marker_her_0.02_ind50000_casual_1/models/bolt_cheat_casual/params_$i
    done
    ~/dsmwpred/patrick/ldak --mega-prs small_chunks_current/chunked_sims/chucks_1_marker_her_0.02_ind50000_casual_1/models/bolt_cheat_casual/sample_${i} --model bolt --summary small_chunks_current/chunked_sims/chucks_1_marker_her_0.02_ind50000_casual_1/fine_map_gwas/sample_${i}.summaries --cors small_chunks_current/cors/sample_${i} --power 0.25 --high-LD highld.txt --allow-ambiguous YES --max-threads 4 --parameters small_chunks_current/chunked_sims/chucks_1_marker_her_0.02_ind50000_casual_1/models/bolt_cheat_casual/params_$i
done

